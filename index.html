<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ПК-Консультант</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #050008;
            --bg-panel: rgba(30,10,50,.85);
            --violet-main: #d400ff;
            --violet-soft: #b98cff;
            --text-main: #eadcff;
            --border-violet: rgba(180,80,255,.6);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: 'Orbitron',sans-serif;
            color: var(--text-main);
            background: radial-gradient(circle at 20% 20%, rgba(200,0,255,.18), transparent 45%), radial-gradient(circle at 80% 80%, rgba(120,0,255,.18), transparent 45%), linear-gradient(180deg,#050008,#120016);
            animation: bgFlow 20s ease-in-out infinite alternate;
            overflow-x: hidden;
        }

        @keyframes bgFlow {
            0% {
                background-position: 0 0,100% 100%,0 0;
            }

            100% {
                background-position: 100% 100%,0 0,0 100%;
            }
        }

        .matrix {
            position: fixed;
            top: 0;
            bottom: 0;
            width: 15%;
            pointer-events: none;
            z-index: 1;
        }

            .matrix.left {
                left: 0;
            }

            .matrix.right {
                right: 0;
            }

            .matrix span {
                position: absolute;
                top: 0;
                font-size: 14px;
                pointer-events: none;
                will-change: transform;
                transform: translateZ(0);
            }

        @keyframes fall {
            to {
                transform: translateY(110vh);
                opacity: 0;
            }
        }

        .header {
            text-align: center;
            padding: 50px 20px 30px;
            position: relative;
            z-index: 2;
            opacity: 0;
            transform: translateY(-20px);
            animation: fadeDown 1.2s ease forwards;
        }

        @keyframes fadeDown {
            to {
                opacity: 1;
                transform: none;
            }
        }

        .header h1 {
            font-size: 64px;
            margin: 0;
            letter-spacing: 5px;
            color: #f3d6ff;
            position: relative;
            display: inline-block;
            text-shadow: 0 0 8px rgba(212,0,255,.8), 0 0 15px rgba(212,0,255,.6), 0 0 25px rgba(212,0,255,.5), 0 0 35px rgba(212,0,255,.4), 0 0 50px rgba(212,0,255,.3);
            animation: glowAnim 3s ease-in-out infinite;
        }

        @keyframes glowAnim {
            0%,100% {
                text-shadow: 0 0 8px rgba(212,0,255,.8), 0 0 15px rgba(212,0,255,.6), 0 0 25px rgba(212,0,255,.5), 0 0 35px rgba(212,0,255,.4), 0 0 50px rgba(212,0,255,.3);
            }

            50% {
                text-shadow: 0 0 12px rgba(255,0,255,.9), 0 0 25px rgba(255,0,255,.7), 0 0 35px rgba(255,0,255,.6), 0 0 50px rgba(255,0,255,.5), 0 0 70px rgba(255,0,255,.4);
            }
        }

        .lang-btn {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            padding: 10px 18px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 0 14px rgba(180,80,255,.35);
            font-weight: 600;
            transition: all .3s ease;
            color: #fff;
        }

            .lang-btn:hover {
                box-shadow: 0 0 28px rgba(180,80,255,.7);
                transform: translateY(-2px) scale(1.05);
            }

        .container {
            width: 85%;
            margin: 20px auto 40px;
            padding: 30px;
            background: var(--bg-panel);
            border-radius: 16px;
            box-shadow: 0 0 42px rgba(140,0,255,.28), inset 0 0 26px rgba(0,0,0,.7);
            z-index: 2;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeUp 1.2s ease forwards;
            animation-delay: 1s;
        }

        @keyframes fadeUp {
            to {
                opacity: 1;
                transform: none;
            }
        }

        .main-layout {
            display: grid;
            grid-template-columns: 330px 1fr;
            gap: 30px;
            align-items: stretch;
        }

        input {
            width: 220px;
            padding: 12px;
            margin-bottom: 18px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 10px;
            color: var(--text-main);
            font-family: 'Orbitron';
        }

            input:focus {
                box-shadow: 0 0 12px rgba(180,80,255,.9);
                outline: none;
            }

        .select {
            position: relative;
            width: 220px;
            margin-bottom: 18px;
        }

        .select-btn {
            padding: 12px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 10px;
            cursor: pointer;
            transition: .25s;
        }

            .select-btn:hover {
                box-shadow: 0 0 22px rgba(255,0,255,.75);
            }

        .select-list {
            position: absolute;
            top: 110%;
            left: 0;
            right: 0;
            background: rgba(20,10,40,.98);
            border-radius: 10px;
            overflow: hidden;
            max-height: 0;
            opacity: 0;
            transform: translateY(-10px);
            transition: .35s ease;
            box-shadow: 0 0 35px rgba(180,80,255,.5);
            z-index: 10;
        }

        .select.open .select-list {
            max-height: 300px;
            opacity: 1;
            transform: translateY(0);
        }

        .select-list div {
            padding: 12px;
            cursor: pointer;
            transition: .25s;
        }

            .select-list div:hover {
                background: linear-gradient(90deg,#6a00cc,#a24dff);
                box-shadow: inset 0 0 12px rgba(180,80,255,.6);
            }

        button {
            margin-top: 10px;
            padding: 12px 26px;
            background: linear-gradient(90deg,#ff00ff,#7f5bff);
            border: none;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            font-family: 'Orbitron';
            box-shadow: 0 0 22px rgba(255,0,255,.6);
            transition: .3s;
        }

            button:hover {
                box-shadow: 0 0 34px rgba(255,0,255,.85);
                transform: scale(1.04);
            }

        .result-box {
            padding: 25px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 16px;
            box-shadow: 0 0 32px rgba(180,80,255,.45), inset 0 0 18px rgba(0,0,0,.7);
            white-space: pre-wrap;
            overflow-y: auto;
            min-height: 100%;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .nav-btn {
            padding: 12px 22px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 10px;
            color: #fff;
            text-decoration: none;
            box-shadow: 0 0 14px rgba(180,80,255,.35);
            transition: .25s;
        }

            .nav-btn:hover {
                box-shadow: 0 0 22px rgba(180,80,255,.65);
                transform: translateY(-1px);
            }

        .footer {
            text-align: center;
            padding: 15px;
            font-size: 12px;
            color: var(--violet-soft);
            z-index: 2;
        }

        /* ===== ДОБАВЛЕНО (не влияет на остальные кнопки) ===== */

        .how-toggle {
            width: 100%;
            margin-bottom: 15px;
        }

        .how-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height .5s ease, opacity .4s ease;
            opacity: 0;
        }

            .how-content.active {
                max-height: 600px;
                opacity: 1;
                margin-bottom: 20px;
            }

        .how-inner {
            padding: 20px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 16px;
            box-shadow: 0 0 32px rgba(180,80,255,.45), inset 0 0 18px rgba(0,0,0,.7);
        }

        .how-toggle {
            width: 100%;
            margin-bottom: 15px;
        }

        .how-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height .5s ease, opacity .4s ease;
            opacity: 0;
        }

            .how-content.active {
                max-height: 500px;
                opacity: 1;
                margin-bottom: 20px;
            }

        .how-inner {
            padding: 20px;
            background: rgba(10,5,20,.9);
            border: 2px solid var(--border-violet);
            border-radius: 16px;
            box-shadow: 0 0 32px rgba(180,80,255,.45), inset 0 0 18px rgba(0,0,0,.7);
        }
        /* ===== ОДНОРАЗОВЫЙ ФИОЛЕТОВЫЙ БЛИК С ПЛАВНЫМ ЗАТУХАНИЕМ ===== */

        .container {
            position: relative;
            border-radius: 16px;
        }

            /* основная линия */
            .container::before {
                content: "";
                position: absolute;
                inset: 0;
                border-radius: 16px;
                padding: 2px;
                background: linear-gradient( 120deg, transparent 0%, transparent 40%, rgba(180, 0, 255, 0.0) 45%, rgba(210, 0, 255, 0.9) 48%, rgba(255, 255, 255, 1) 50%, rgba(210, 0, 255, 0.9) 52%, rgba(180, 0, 255, 0.0) 55%, transparent 60%, transparent 100% );
                background-size: 250% 250%;
                background-position: -200% 0;
                opacity: 0;
                -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                -webkit-mask-composite: xor;
                mask-composite: exclude;
                pointer-events: none;
            }

            /* мягкое внешнее свечение */
            .container::after {
                content: "";
                position: absolute;
                inset: -5px;
                border-radius: 22px;
                background: linear-gradient( 120deg, transparent 0%, transparent 40%, rgba(180, 0, 255, 0.0) 45%, rgba(210, 0, 255, 0.8) 48%, rgba(255, 255, 255, 0.9) 50%, rgba(210, 0, 255, 0.8) 52%, rgba(180, 0, 255, 0.0) 55%, transparent 60%, transparent 100% );
                background-size: 250% 250%;
                background-position: -200% 0;
                filter: blur(18px);
                opacity: 0;
                z-index: -1;
                pointer-events: none;
            }

            /* запуск один раз */
            .container:hover::before,
            .container:hover::after {
                animation: neonOnce 3.5s ease forwards;
            }

        @keyframes neonOnce {

            0% {
                background-position: -200% 0;
                opacity: 1;
            }

            70% {
                opacity: 1;
            }

            100% {
                background-position: 200% 0;
                opacity: 0; /* плавное исчезновение */
            }
        }
    </style>
</head>

<body>

    <div class="matrix left"></div>
    <div class="matrix right"></div>

    <div class="header">
        <h1>ПК-КОНСУЛЬТАНТ</h1>
        <button class="lang-btn" id="langBtn">RU</button>
        <div class="subheading" id="subheading">Подбор комплектующих для ПК онлайн</div>
    </div>

    <div class="container">

        <button class="how-toggle" id="howToggle">Как пользоваться сайтом</button>

        <div class="how-content" id="howContent">
            <div class="how-inner">
                <p><strong>1.</strong> Введите бюджет который предпочитаете для сборки, учитывайте то что это сборка только системного блока без монитора!</p>
                <p><strong>2.</strong> Выберите производителя видеокарты или оставьте «Авто».</p>
                <p><strong>3.</strong> Выберите производителя процессора или оставьте «Авто».</p>
                <p><strong>4.</strong> Укажите задачи ПК — игры, работа или универсальный вариант.</p>
                <p><strong>5.</strong> Нажмите «Подобрать комплектующие» и дождитесь результата.</p>
                <p>Остальные страницы сайта носят информационный характер и помогают лучше разобраться в теме.</p>
            </div>
        </div>

        <div class="main-layout">

            <div>
                <p id="budgetLabel">Ваш бюджет (мин. 20 000 руб.):</p>
                <input type="number" id="budget" min="20000" placeholder="Введите сумму от 20 000">

                <p id="gpuLabel">Производитель видеокарты:</p>
                <div class="select" data-name="gpu">
                    <div class="select-btn">Авто</div>
                    <div class="select-list">
                        <div data-ru="Авто" data-en="Auto">Авто</div>
                        <div data-ru="NVIDIA" data-en="NVIDIA">NVIDIA</div>
                        <div data-ru="AMD" data-en="AMD">AMD</div>
                    </div>
                </div>

                <p id="cpuLabel">Производитель процессора:</p>
                <div class="select" data-name="cpu">
                    <div class="select-btn">Авто</div>
                    <div class="select-list">
                        <div data-ru="Авто" data-en="Auto">Авто</div>
                        <div data-ru="Intel" data-en="Intel">Intel</div>
                        <div data-ru="AMD" data-en="AMD">AMD</div>
                    </div>
                </div>

                <p id="tasksLabel">Задачи ПК:</p>
                <div class="select" data-name="tasks">
                    <div class="select-btn">Авто</div>
                    <div class="select-list">
                        <div data-ru="Авто" data-en="Auto">Авто</div>
                        <div data-ru="Игры" data-en="Gaming">Игры</div>
                        <div data-ru="Работа" data-en="Work">Работа</div>
                        <div data-ru="Игры и работа" data-en="Gaming & Work">Игры и работа</div>
                    </div>
                </div>

                <button id="generate">Подобрать комплектующие</button>
            </div>

            <div class="result-box" id="result"></div>

        </div>

        <div class="nav-buttons">
            <a href="index.html" class="nav-btn" id="navBuild">Сборка ПК</a>
            <a href="about.html" class="nav-btn" id="navAbout">Что такое ПК?</a>
            <a href="tips.html" class="nav-btn" id="navTips">Советы по сборке</a>
            <a href="top-components.html" class="nav-btn" id="navTop">Топ комплектующих</a>
        </div>
    </div>

    <div class="footer">© 2026 MiniKapi. Все права защищены.</div>

    <script>
        // MATRIX
        document.querySelectorAll('.matrix').forEach(side => {

            const SYMBOL_COUNT = 40; // оптимально для слабых ПК
            const symbols = [];

            for (let i = 0; i < SYMBOL_COUNT; i++) {

                const span = document.createElement('span');
                span.textContent = Math.random() > 0.5 ? '1' : '0';

                span.style.left = Math.random() * 100 + '%';
                span.style.transform = `translateY(${Math.random() * 100}vh)`;
                span.style.opacity = 0.6 + Math.random() * 0.3;

                side.appendChild(span);

                symbols.push({
                    el: span,
                    speed: 0.2 + Math.random() * 0.3,
                    y: Math.random() * 110
                });
            }

            function animate() {
                for (let s of symbols) {

                    s.y += s.speed;

                    if (s.y > 110) {
                        s.y = -5;
                        s.el.textContent = Math.random() > 0.5 ? '1' : '0';
                        s.el.style.left = Math.random() * 100 + '%';
                    }

                    s.el.style.transform = `translateY(${s.y}vh)`;
                }

                requestAnimationFrame(animate);
            }

            requestAnimationFrame(animate);
        });

        // SELECT
        document.querySelectorAll('.select').forEach(sel => {
            const btn = sel.querySelector('.select-btn');
            const list = sel.querySelector('.select-list');
            btn.onclick = () => {
                document.querySelectorAll('.select').forEach(s => s !== sel && s.classList.remove('open'));
                sel.classList.toggle('open');
            };
            list.querySelectorAll('div').forEach(opt => {
                opt.onclick = () => {
                    btn.textContent = opt.getAttribute('data-' + lang);
                    sel.classList.remove('open');
                };
            });
        });

        document.addEventListener('click', e => {
            if (!e.target.closest('.select')) {
                document.querySelectorAll('.select').forEach(s => s.classList.remove('open'));
            }
        });

        let lang = localStorage.getItem('lang') || 'ru';

        const dict = {
            ru: {
                h1: 'ПК-КОНСУЛЬТАНТ',
                subheading: 'Подбор комплектующих для ПК онлайн',
                budgetLabel: 'Ваш бюджет (мин. 20 000 руб.):',
                budgetPlaceholder: 'Введите сумму от 20 000',
                generate: 'Подобрать комплектующие',
                navBuild: 'Сборка ПК',
                navAbout: 'Что такое ПК?',
                navTips: 'Советы по сборке',
                navTop: 'Топ комплектующих',
                howBtn: 'Как пользоваться сайтом',
                howText: `
1. Введите бюджет который предпочитаете для сборки. Это сборка только системного блока без монитора.

2. Выберите производителя видеокарты или оставьте «Авто».

3. Выберите производителя процессора или оставьте «Авто».

4. Укажите задачи ПК — игры, работа или универсальный вариант.

5. Нажмите «Подобрать комплектующие» и дождитесь результата.

Остальные страницы сайта носят информационный характер и помогают лучше разобраться в теме.
                        `,
                minBudget: 20000
            },

            en: {
                h1: 'PC CONSULTANT',
                subheading: 'Online PC parts selection',
                budgetLabel: 'Your budget (min. $250):',
                budgetPlaceholder: 'Enter amount from $250',
                generate: 'Build PC',
                navBuild: 'Build PC',
                navAbout: 'What is a PC?',
                navTips: 'Assembly Tips',
                navTop: 'Top Components',
                howBtn: 'How to use the site',
                howText: `
1. Enter the budget you prefer for the build. This is for the system unit only (no monitor).

2. Choose a GPU manufacturer or leave it on “Auto”.

3. Choose a CPU manufacturer or leave it on “Auto”.

4. Select the PC purpose — gaming, work or universal.

5. Click “Build PC” and wait for the result.

Other pages on the site are informational and help you better understand PC components.
                        `,
                minBudget: 250
            }
        };

        const langBtn = document.getElementById('langBtn');
        const howToggle = document.getElementById('howToggle');
        const howContent = document.getElementById('howContent');

        function applyLang() {
            document.querySelector('.header h1').textContent = dict[lang].h1;
            document.getElementById('subheading').textContent = dict[lang].subheading;
            document.getElementById('budgetLabel').textContent = dict[lang].budgetLabel;
            document.getElementById('budget').placeholder = dict[lang].budgetPlaceholder;
            document.getElementById('generate').textContent = dict[lang].generate;
            document.getElementById('navBuild').textContent = dict[lang].navBuild;
            document.getElementById('navAbout').textContent = dict[lang].navAbout;
            document.getElementById('navTips').textContent = dict[lang].navTips;
            document.getElementById('navTop').textContent = dict[lang].navTop;

            // ПЕРЕВОД КНОПКИ И ТЕКСТА
            howToggle.textContent = dict[lang].howBtn;
            howContent.querySelector('.how-inner').innerText = dict[lang].howText;

            langBtn.textContent = lang.toUpperCase();

            document.querySelectorAll('.select').forEach(sel => {
                sel.querySelectorAll('.select-list div').forEach(opt => {
                    opt.textContent = opt.getAttribute('data-' + lang);
                });
                sel.querySelector('.select-btn').textContent =
                    sel.querySelector('.select-list div:first-child')
                        .getAttribute('data-' + lang);
            });

            localStorage.setItem('lang', lang);
        }

        langBtn.onclick = () => {
            lang = (lang === 'ru') ? 'en' : 'ru';
            applyLang();
        };

        applyLang();

        // TOGGLE HOW SECTION
        howToggle.addEventListener('click', () => {
            howContent.classList.toggle('active');
        });

        // LOADING + TYPING
        async function typeText(el, text) {
            el.textContent = "";
            for (let i = 0; i < text.length; i++) {
                el.textContent += text[i];
                await new Promise(r => setTimeout(r, 15));
            }
        }

        function showLoading(el) {
            el.textContent = lang === 'ru'
                ? "⌛ Подбираем комплектующие..."
                : "⌛ Building parts...";
        }

        // GENERATE
        document.getElementById('generate').onclick = async () => {
            const result = document.getElementById('result');
            const budgetInput = document.getElementById('budget');
            const budget = parseInt(budgetInput.value);

            if (isNaN(budget) || budget < dict[lang].minBudget) {
                result.textContent = lang === 'ru'
                    ? "Минимальный бюджет 20 000 руб."
                    : "Minimum budget $250";
                return;
            }

            const values = {
                gpu: document.querySelector('.select[data-name="gpu"] .select-btn').textContent,
                cpu: document.querySelector('.select[data-name="cpu"] .select-btn').textContent,
                tasks: document.querySelector('.select[data-name="tasks"] .select-btn').textContent
            };

            showLoading(result);

            try {
                const res = await fetch("/api/build", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ budget, gpu: values.gpu, cpu: values.cpu, tasks: values.tasks, lang })
                });

                const data = await res.json();
                await typeText(result, data.result);

            } catch (err) {
                console.error(err);
                result.textContent = lang === 'ru'
                    ? "❌ Ошибка сервера. Попробуйте позже."
                    : "❌ Server error. Try later.";
            }
        };
    </script>

</body>
</html>
